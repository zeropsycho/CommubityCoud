<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zero.hjy.dao.UserMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.zero.hjy.entity.User">
        <id column="id" property="id" />
        <result column="u_username" property="username" />
        <result column="u_password" property="password" />
        <result column="u_nickname" property="uNickname" />
        <result column="u_gender" property="uGender" />
        <result column="u_birthdate" property="uBirthdate" />
        <result column="u_remarks" property="uRemarks" />
        <result column="u_email" property="uEmail" />
        <result column="u_mobile_phone" property="uMobilePhone" />
        <result column="u_office_phone" property="uOfficePhone" />
        <result column="u_faxa_phone" property="uFaxaPhone" />
        <result column="u_status" property="uStatus" />
        <result column="u_start_effect" property="uStartEffect" />
        <result column="u_end_effect" property="uEndEffect" />
        <result column="u_crate_time" property="uCrateTime" />
        <result column="u_update_time" property="uUpTimestamp" />
        <result column="c_post_id" property="cPostId" />
        <result column="c_department_id" property="cDepartmentId" />
        <result column="r_id" property="rId" />
        <result column="delete_status" property="deleteStatus" />
        <association property="role" javaType="com.zero.hjy.entity.Role">
            <result property="name" column="name"></result>
            <result property="status" column="status"></result>
        </association>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, u_username, u_password, u_nickname, u_gender, u_birthdate, u_remarks, u_email, u_mobile_phone,
        u_office_phone, u_faxa_phone, u_status, u_start_effect, u_end_effect, u_crate_time, u_update_time, c_post_id,
        c_department_id, r_id, delete_status
    </sql>

    <select id="userAndRole" resultMap="BaseResultMap">
        select * from tab_user u
        <trim suffixOverrides="where" prefixOverrides="or | and">
            <if test="username != null and '' != username">
                u.username = {username}
            </if>
            LEFT JOIN tab_user_role ur
            on u.id = ur.u_id
            LEFT JOIN tab_role r
            on r.id = ur.r_id
        </trim>
    </select>


</mapper>
